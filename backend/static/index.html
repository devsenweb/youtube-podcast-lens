<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://www.youtube.com/iframe_api"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Podcast Lens</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <h1>YouTube Podcast Lens<br> </h1>
  https://www.youtube.com/watch?v=v4OeGKUACmc&ab_channel=TomGreen <br>
  https://www.youtube.com/watch?v=qQMjKrrgLRo&ab_channel=1MinutePodcast<br>
  <div>
    <input id="videoIdInput" type="text" placeholder="Enter YouTube URL or Video ID">
    <button id="fetchTranscriptBtn" onclick="window.fetchTranscript()">Fetch Transcript</button>
    <label style="margin-left:1em;"><input type="checkbox" id="regenerateCheckbox"> Regenerate</label>
</div>

</div>
<div style="display: flex; flex-direction: row; gap: 2em; margin: 1em 0; align-items: flex-start;">
  <div>
    <div id="youtubePlayer" style="width:400px; height:225px;"></div>
    <div id="playerTime" style="margin-top: 0.5em;"></div>
  </div>
  <div id="keywordImagePanel" style="min-width: 240px; max-width: 320px;">
  <div id="unsplashImagePreview" style="width:100%;height:180px;background:#eee;border-radius:10px;overflow:hidden;display:flex;align-items:center;justify-content:center;margin-bottom:0.5em;"></div>
    <h3>Keywords & Images</h3>
    <div id="keywordsAtPlayhead">(No keywords yet)</div>
    <div id="imagesAtPlayhead" style="display: flex; flex-wrap: wrap; gap: 0.5em;"></div>
  </div>
</div>
  <pre id="transcript"></pre>
  <div style="margin:1em 0;">
    <label for="topicSegmentsOutput"><b>Topic Segments (timestamp & keyword):</b></label><br>
    <textarea id="topicSegmentsOutput" style="width:100%;min-height:80px;" readonly></textarea>
  </div>
  <div id="loadingModal" style="display:none;position:fixed;z-index:2000;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.65);backdrop-filter:blur(2px);">
    <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#222;padding:2.5em 2em 2em 2em;border-radius:14px;box-shadow:0 4px 32px #000a;min-width:320px;max-width:90vw;text-align:center;">
      <div class="spinner" style="margin-bottom:1.2em;width:48px;height:48px;border:6px solid #eee;border-top:6px solid #4ad; border-radius:50%;animation:spin 1s linear infinite;display:inline-block;"></div>
      <div id="loadingStatusMsg" style="color:#fff;font-size:1.2em;margin-top:0.5em;">Preparing visuals. Please wait while we analyze the transcript and generate topic images...</div>
    </div>
  </div>
  <style>@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}</style>

  <div id="visualsBanner" style="display:none;position:fixed;top:0;left:0;width:100vw;background:#222;color:#fff;font-size:1.2em;padding:0.7em 0;text-align:center;z-index:1000;box-shadow:0 2px 8px #0008;letter-spacing:1px;">Generating visuals...</div>

  <div id="mainContent" style="display:none;">
    <div style="margin:2em 0 1em 0;">
      <div id="segmentImagesPreview" style="display:flex;flex-wrap:wrap;gap:1em;margin-top:1em;"></div>
    </div>
  </div>
  
  <!-- Load main.js BEFORE setting up event listeners -->
  <script src="/static/main.js"></script>
</body>
</html>